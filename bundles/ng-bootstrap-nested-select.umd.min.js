!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("tslib"),require("@angular/core"),require("@ng-bootstrap/ng-bootstrap"),require("string-similarity"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("ng-bootstrap-nested-select",["exports","tslib","@angular/core","@ng-bootstrap/ng-bootstrap","string-similarity","@angular/common","@angular/forms"],e):e((t=t||self)["ng-bootstrap-nested-select"]={},t.tslib,t.ng.core,t["@ng-bootstrap/ng-bootstrap"],t["string-similarity"],t.ng.common,t.ng.forms)}(this,(function(t,e,n,i,o,s,l){"use strict";var r;(r=t.KEY_CODE||(t.KEY_CODE={}))[r.ENTER=13]="ENTER",r[r.UP_ARROW=38]="UP_ARROW",r[r.DOWN_ARROW=40]="DOWN_ARROW";var d=function(){this.filter={fields:["name"]},this.field="options",this.scroll=!0,this.top=!1,this.selectAll=!1,this.label="name",this.collapsed=!1,this.clear="Clear",this.strict=!0,this.actions=null,this.required=!1,this.indexedOptions=!1,this.numberInput=!1,this.matchRating=.4,this.emptyText="No Options Available",this.popoverTitle="Details:"},p=function(){function s(t,e){this.cb=t,this.ngbConfig=e,this.disable=!1,this.required=!1,this.invalid=!0,this._options=[],this.settings=new d,this._disabled=!1,this.selectExpand=!1,this.actions=[],this.selected=new n.EventEmitter,this.actionSelected=new n.EventEmitter,this._optionsFiltered=[],this._searchTerm="",this._selected={},this.filterOn=!0,this.ngbConfig.autoClose="outside"}return Object.defineProperty(s.prototype,"options",{set:function(t){var e=this;this.setOptions(t),setTimeout((function(){e.resetSelected(e._options)}),500)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"default",{set:function(t){this._selected="object"==typeof t?e.__assign({},t):{name:t,selected:!0},t&&(this.filterOn=!1),this.validate()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"disabled",{set:function(t){this.disable=!!t,this._disabled=t},enumerable:!0,configurable:!0}),s.prototype.ngOnInit=function(){var t=new d;for(var e in t)this.settings[e]||!1===this.settings[e]||(this.settings[e]=t[e]);this.settings.required&&(this.required=!0,this.validate()),this.cb.markForCheck()},s.prototype.keyEvent=function(e){switch(e.keyCode){case t.KEY_CODE.UP_ARROW:case t.KEY_CODE.DOWN_ARROW:this.arrowOption(e.keyCode);break;case t.KEY_CODE.ENTER:this.selectOption(null,this._selected)}},s.prototype.hasOptions=function(){var t=this;return this._options.filter((function(e){if(e[t.settings.label]&&""!==e[t.settings.label])return!0})).length>0},s.prototype.resetSelected=function(t){var e=this;void 0===t&&(t=[]),t.forEach((function(t){t.selected=!1,t.collapsed=!1,e.settings&&t[e.settings.field]&&t[e.settings.field].length>0&&e.resetSelected(t[e.settings.field])}))},s.prototype.selectOption=function(t,n,i,o){void 0===n&&(n=null),void 0===i&&(i=!1),void 0===o&&(o=!1),n||((n={selected:!0})[this.settings.label]=t),i||n[this.settings.field]&&n[this.settings.field].length&&!this.settings.selectAll&&!o?(n.selected=!n.selected,t.stopPropagation(),t.preventDefault()):(this._selected=e.__assign({},n),this._searchTerm=this._selected[this.settings.label],this.settings.indexedOptions?this.selected.emit(n[this.settings.label]):this.selected.emit(n),this.settings.selectAll||(this.filterOn=!1),this.nestedDropRef.close()),this.validate(),this.cb.detectChanges()},s.prototype.selecWithOptions=function(t,e){void 0===e&&(e=null),this.selectOption(t,e,!1,this.selectExpand)},s.prototype.validate=function(){Object.keys(this._selected).length>0?this.invalid=!1:this.invalid=!0},s.prototype.filterOptions=function(t,e){var n=this;if(void 0===t&&(t=null),void 0===e&&(e=[]),this.nestedDropRef.open(),0!==this._searchTerm.length){t||(this._optionsFiltered=[],this._searchTerm||(this._optionsFiltered=this._options.slice(0)),t=this._searchTerm,e=this._options.slice(0));var i=-1;return e.forEach((function(e,s){n.settings.filter.fields.forEach((function(s){var l=e[s];i=l.search(new RegExp(t,"i"));var r=o.compareTwoStrings(l,t);(i>=0||r>=n.settings.matchRating)&&n._optionsFiltered.indexOf(e)<0&&(e.match=r,n._optionsFiltered.push(e))})),e[n.settings.field]&&e[n.settings.field].length&&(i=n.filterOptions(t,e[n.settings.field]))})),this._optionsFiltered.sort((function(t,e){return e.match-t.match})),i}},s.prototype.arrowOption=function(e){if(this.filterOn=!1,this._selected)for(var n=0;n<this._optionsFiltered.length;n++){var i=this._optionsFiltered[n],o=1;if(e===t.KEY_CODE.UP_ARROW&&(o=-1),i===this._selected&&this._optionsFiltered[n+o]){this._selected=this._optionsFiltered[n+o];break}}else this._selected=this._optionsFiltered[0]},s.prototype.selectAction=function(t){this.actionSelected.emit(t)},s.prototype.showFilter=function(){var t=this;this._optionsFiltered=this._options.slice(0),this.filterOn=!0,this._searchTerm="",setTimeout((function(){t.filterInputRef.nativeElement.focus(),t.nestedDropRef.open()}),100)},s.prototype.hideFilter=function(){this.filterOn=!1},s.prototype.setOptions=function(t){var n=this;this._options=[],t.forEach((function(t){if("object"==typeof t){var i=e.__assign({},t);i.selected=!1,n._options.push(i)}else n._options.push({name:t,selected:!1});n._optionsFiltered=n._options.slice(0)}))},s.ctorParameters=function(){return[{type:n.ChangeDetectorRef},{type:i.NgbDropdownConfig}]},e.__decorate([n.HostBinding("class.disabled")],s.prototype,"disable",void 0),e.__decorate([n.HostBinding("class.required")],s.prototype,"required",void 0),e.__decorate([n.HostBinding("class.invalid")],s.prototype,"invalid",void 0),e.__decorate([n.ViewChild("filterInput",{static:!1})],s.prototype,"filterInputRef",void 0),e.__decorate([n.ViewChild("nestedDrop",{static:!1})],s.prototype,"nestedDropRef",void 0),e.__decorate([n.Input()],s.prototype,"options",null),e.__decorate([n.Input()],s.prototype,"default",null),e.__decorate([n.Input()],s.prototype,"settings",void 0),e.__decorate([n.Input()],s.prototype,"disabled",null),e.__decorate([n.Input()],s.prototype,"selectExpand",void 0),e.__decorate([n.Input()],s.prototype,"actions",void 0),e.__decorate([n.Output()],s.prototype,"selected",void 0),e.__decorate([n.Output()],s.prototype,"actionSelected",void 0),e.__decorate([n.HostListener("window:keyup",["$event"])],s.prototype,"keyEvent",null),s=e.__decorate([n.Component({selector:"nested-select",template:'<ng-template #optionTemplate let-options="options" let-i="index">\n  <ng-template ngFor [ngForOf]="options" let-opt>\n    <div\n      [ngClass]="{\n        \'option\':true,\n        \'and-end\':true,\n        \'text-primary\': opt == _selected\n      }"\n    >\n         \x3c!-- (click)="selectOption($event, opt)"> --\x3e\n            <div *ngIf="opt[settings.field] && opt[settings.field].length && settings.collapsed"\n                  class="d-inline"\n                  (click)="selectOption($event, opt)">\n                  <span \n                  class="fa mr-2 toggle-icon"\n                  [ngClass]="{\n                    \'arrow-right\': !opt.selected && !settings.selectAll,\n                    \'arrow-down\': opt.selected && !settings.selectAll,\n                    \'click-arrow-right\': !opt.selected,\n                    \'click-arrow-down\': opt.selected,\n                    \'click-arrow\': settings.selectAll\n                  }"></span>\n            </div>\n      <span (click)="selecWithOptions($event, opt)" [innerHTML]="opt[settings.label]" class="option-label"></span>\n    </div>\n    <div class="option-container" *ngIf="opt[settings.field] && opt[settings.field].length && (!settings.collapsed || opt.selected)">\n      <div\n        [ngTemplateOutlet]="optionTemplate"\n        [ngTemplateOutletContext]="{options: opt[settings.field], index: (i+1)}">\n      </div>\n    </div>\n  </ng-template>\n</ng-template>\n<div *ngIf="_disabled && settings.popoverTitle"\n     class="filter-read"\n     [innerHTML]="_selected[settings.label]"\n     placement="top"\n     popoverTitle={{settings.popoverTitle}}\n     #p="ngbPopover"\n     [ngbPopover]="productName"\n     triggers="mouseenter:mouseleave">\n</div>\n<div [ngStyle]="{\'display\':!_disabled?\'block\':\'none\'}">\n  <div\n       ngbDropdown=""\n       class="nested-select"\n       #nestedDrop="ngbDropdown"\n       (openChange)="resetSelected(_options)">\n    <ng-template [ngIf]="!settings.strict">\n      <div *ngIf="settings.filter && filterOn">\n        <input\n               ngbDropdownAnchor=""\n               (focus)="nestedDrop.open()"\n               type="text"\n               name="filterInput"\n               id="filterInput"\n               [(ngModel)]="_searchTerm"\n               (ngModelChange)="filterOptions()"\n               #filterInput (click)="filterOptions()"\n               (focusout)="hideFilter()"\n               autocomplete="off" />\n      </div>\n      <div *ngIf="!settings.filter">\n        <input\n               ngbDropdownAnchor=""\n               (focus)="nestedDrop.open()"\n               [type]="(settings.numberInput ? \'number\' : \'text\')"\n               name="typedInput"\n               id="typedInput"\n               [(ngModel)]="_selected[settings.label]"\n               #typedInput\n               (ngModelChange)="selectOption($event)"\n               autocomplete="off" />\n      </div>\n      <div *ngIf="settings.filter && !filterOn">\n        <div\n             ngbDropdownToggle=""\n             class="filter-read"\n             [innerHTML]="_selected[settings.label]"\n             (click)="showFilter();">\n        </div>\n      </div>\n    </ng-template>\n    <div *ngIf="settings.strict">\n      <div\n           ngbDropdownToggle=""\n           class="filter-read"\n           [innerHTML]="_selected[settings.label]">\n      </div>\n    </div>\n  \n    <div ngbDropdownMenu=""\n         aria-labelledby="dropdownMenuButton"\n         [ngClass]="{\n              \'scroll\': settings.scroll,\n              \'top\': settings.top\n            }">\n  \n      <div *ngIf="hasOptions() && settings.clear && settings.actions != \'buttons\'"\n           class="option text-secondary dropdown-item clear"\n           (click)="selectOption(null)">\n        {{settings.clear}}\n      </div>\n      <ng-template [ngIf]="(actions.length > 0) && settings.actions != \'buttons\'">\n        <div class="option text-secondary dropdown-item"\n             *ngFor="let action of actions"\n             (click)="selectAction(action)"\n             [innerHTML]="action.label">\n        </div>\n      </ng-template>\n  \n      <div class="option dropdown-item" *ngIf="settings.actions == \'buttons\'">\n        <ng-template [ngIf]="(actions.length > 0)">\n          <div class="btn btn-xs btn-light float-right ml-1"\n               *ngFor="let action of actions"\n               (click)="selectAction(action)"\n               [innerHTML]="action.label">\n          </div>\n        </ng-template>\n        <div class="btn btn-xs btn-light float-right ml-1"\n             *ngIf="hasOptions() && settings.clear"\n             (click)="selectOption(null)">\n          {{settings.clear}}\n        </div>\n      </div>\n  \n      <div class="option" *ngIf="!hasOptions()">{{settings.emptyText}}</div>\n      <div\n        [ngTemplateOutlet]="optionTemplate"\n        [ngTemplateOutletContext]="{options: _optionsFiltered, index: 1}">\n      </div>\n    </div>\n  </div>\n</div>\n\n<ng-template #productName>\n  <div [innerHTML]="_selected[settings.label]"></div>\n</ng-template>\n',changeDetection:n.ChangeDetectionStrategy.OnPush,styles:[".nested-select{border:none;padding:0;margin:0;height:100%;width:100%;position:relative}.dropdown-toggle::after{position:absolute;right:0;top:40%}.dropdown-menu{width:100%}.dropdown-menu.scroll{overflow-y:scroll;max-height:300px}.dropdown-menu.show{left:0}.dropdown-toggle{height:100%;width:100%;cursor:pointer;position:relative}.option{padding:0 .3rem;font-style:italic}.dropdown-item{color:#000;cursor:pointer;font-style:normal}.and-end{display:block;width:100%;padding:.25rem 1.5rem;clear:both;font-weight:400;text-align:inherit;white-space:nowrap;background-color:transparent;border:0;color:#000;cursor:pointer;font-style:normal}.option-container{border-left:1px solid #ccc;margin-left:.8rem}input{border:none}.clear{font-style:italic;color:#aaa!important}.filter-read{overflow:hidden;padding-right:4px;text-overflow:ellipsis}.option:hover .option-label{color:var(--primary)}.option:hover .toggle-icon{color:initial}.toggle-icon:hover{color:var(--primary)!important}.arrow-right{width:0;height:0;display:inline-block;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:5px solid #aaa}.arrow-down{width:0;height:0;display:inline-block;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid #ccc}.click-arrow{display:inline-block;height:16px;width:16px;vertical-align:middle}.click-arrow-right{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAByUlEQVQ4jZ2TMWiTURSFv/OTIUiGUEoRCcUhBAdxea8gIg4dOzopuGkQJ5HgXDqLdA7azcHRqZM4FCli/wfiVIo4lAxSghQJpRTJcXl/+E0mvcuDd94599x735Ux85HK1Aa6QDtfnQLfQgyn829VF0hlKoCbtp9Iug1cztAPYA8Y2v4U1+J0QSCVqbB9V9ILYBUogHE+l4ApcAwMbL+rRIqamxuSXgJX8/0x0Ace2v5uu8jYtqTrFanI2ZtA33anAmyPbR8Cu5I2JU0y1LHdLw/K5kzAds/2erZ5AoyAFUmbQCPE8AZ4BvzMnHVJPYAGgKRl2x1Jo/xwIqky08jnW9tXJD3PPVqegbabki7lce2GGC7mxxVimKQyvQbuS+rZbtYdnANnttuSNlKZJjXu5xDDr1Smlu1HQEfSWebM7I1z3V1gCFzYBvgoaT+7vCfpKdCyfShpXB/jEfBBUgGs5CxjSVvA71SmB5K2bVf/4b3to5lAiOEc2MkusI3tJdvXbG/Y3gJaubEjSTtxLf5VAsAX24P8mTrAqqRXQJHFpjnBQNLXirSwC7ZvAY8l3cnlAJzY3gOGkvZDDIu7UI9UprbtrqR/28b/iT8f8eQJZ91doAAAAABJRU5ErkJggg==) top left no-repeat}.click-arrow-down{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABvElEQVQ4jZ2Tv2tTURTHP9+HQ5AMoQRRCEWkZBIH3xNExKGzIAiVgpsQRBFE8geIs9TgInTwPxAU5+LQoQi+C8WxlA4lqJQORcKjU74OOS88m0nPdu853x/33HNkzNlIZeoAK0Anrk6A/bzIT87WqkmQypQBN20/kXQbuBipX8A2sGn7a3GjmC4QpDJltu9Leg0s255KOoq6C0AGHAJD259qkqzh5pqkDeAykEn6AawBa7bHtrPIjSRdrUFZqLeAge1enbB9ClTARNKppDrVsz0ov5WtOYHtvu3VOFfApNko28RdFTWrkvoA5wAkdUO9At7Z/gk8bHBMbL+UdAl4CiwD3TmB7Zak88Ae8BY4lrQP/A6BV7a3gK7tu5L6tltNB/V7e7YfSXqTF/nnhoODVKY2MJDUA6rAzH/hGBjbbkt6DqyzGOvAM6BtexyYmYOw/iUaswSMUpkq2x/C4QNgFAJTYMv2Hvw9SNeBj8yGCOBA0otwuQFcCbFD4F5e5LtNBwC7tocxTL0AvAcy20vAFBgDQ0nfa9DCLti+BTyWdIfZCAMc2d4GNiXt5EW+uAvNSGXq2F6R9G/b+D/xB+z71+BSnjoVAAAAAElFTkSuQmCC) top left no-repeat}:host{text-align:left}:host .disabled{background-color:#e9ecef;cursor:not-allowed}@media (min-width:576px){.filter-read{white-space:nowrap}.dropdown-menu{min-width:500px}}"]})],s)}(),a=function(){function t(){}return t=e.__decorate([n.NgModule({declarations:[p],imports:[s.CommonModule,l.FormsModule,i.NgbPopoverModule,i.NgbDropdownModule,i.NgbPopoverModule],exports:[p]})],t)}();t.NgBootstrapNestedSelectComponent=p,t.NgBootstrapNestedSelectDefaultSetting=d,t.NgBootstrapNestedSelectModule=a,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-bootstrap-nested-select.umd.min.js.map